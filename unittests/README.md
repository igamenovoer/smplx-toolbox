rigorous unit tests for core functionality.